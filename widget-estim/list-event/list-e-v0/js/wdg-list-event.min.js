$(document).ready(function(){$(".wdg_reset_focus").focus(function(){if($(this).val()==this.defaultValue){$(this).val("")}}).blur(function(){if($(this).val()==""){$(this).val(this.defaultValue?this.defaultValue:"")}});var c=function(h,g){var f=false;if(h.toLowerCase()==g.toLowerCase()){f=true}if(h.toLowerCase().indexOf(g.toLowerCase())!=-1){f=true}return f};var e=function(f){var g=$(".search-result");g.find("span.number").text(f);g.show()};var b=function(m,k,h){var l=false;var j=m.find(".date-debut").text();var g=m.find(".date-fin").text();var i=a(d(j),d(k));var f=a(d(g),d(h));if(i>=0&&f<=0){l=true}return l};var d=function(h){var g=h.split("/");jour=g[0];mois=g[1]-1;annee=g[2];var f=new Date(annee,mois,jour);return f};var a=function(g,f){var h=g.getTime()-f.getTime();return(h==0?h:h/Math.abs(h))};$(".datepicker").datepicker({changeMonth:true,changeYear:true,showTime:true,dateFormat:"dd/mm/yy",dayNamesMin:["Di","Lu","Ma","Me","Je","Ve","Sa"],monthNamesShort:["Jan","Fev","Mar","Avr","Mai","Jui","Juil","Aou","Sep","Oct","Nov","Dec"]});$(".search-button").click(function(){var m=$(this);var l=m.closest(".bloc-filter").find('input[name="search"]');var g=l.val();if(g==l[0].defaultValue){g=""}var i=m.closest(".bloc-filter").find('input[name="date-debut"]').val();var f=m.closest(".bloc-filter").find('input[name="date-fin"]').val();if(g.length>0||(i.length>0&&f.length>0)){var k=$(".widget_list_event").find("article").removeClass("search");var j=false;var h=0;$.each(k,function(p,s){j=false;if(g.length>0){var o=$(s).find(".title");if(c(o.text(),g)){j=true}var r=$(s).find(".structure-accueil");if(!j&&c(r.text(),g)){j=true}var q=$(s).find(".localisation");if(!j&&c(q.text(),g)){j=true}var n=$(s).find(".description");if(!j&&c(n.text(),g)){j=true}if(j&&i.length>0&&f.length>0){j=b($(s),i,f)}}else{if(i.length>0&&f.length>0){j=b($(s),i,f)}}if(j){$(s).addClass("search");h++}});$(".wdg_paginated").trigger("initialize-pager",true);e(h)}else{$(".wdg_paginated").trigger("initialize-pager",false)}});$(".init-button").click(function(){$(".wdg_paginated").trigger("initialize-pager",false)});$(".wdg_paginated").each(function(){var m=$(this);m.bind("initialize-pager",function(s,r){k(r)});m.prepend('<div class="wdg_pager"></div>');var i=$(".wdg_pager").addClass("pagination");var l=0;var p=3;if(i.data("data")&&i.data("data").nbItemsByPage){p=i.data("data").nbItemsByPage}var n=m.find("article").length;var o=Math.ceil(n/p);var j=function(s){var r=m.find("article").hide();if(s){r=m.find("article.search")}r.slice(l*p,(l+1)*p).show()};var h=function(){$previous=$(".wdg_pager_previous").hide();$next=$(".wdg_pager_next").hide();if(l>0){$previous.show()}if((l+1)<o){$next.show()}numberPage=".number-"+l;$(numberPage).addClass("active").siblings().removeClass("active")};var f=function(r){i.data("currentPage",l);j(r);h()};var k=function(r){q();if(r){n=m.find("article.search").length}else{n=m.find("article").length}e(n);o=Math.ceil(n/p);l=0;g(r);f(r)};var q=function(){i.html("")};var g=function(s){$('<span class="wdg_pager_previous"></span>').prependTo(i).addClass("clickable paginationButton prevPage");$('<span class="wdg_pager_previous"></span>').prependTo(i).addClass("paginationButton firstPage").click(function(){l=0;f()});for(var r=0;r<o;r++){$('<span class="wdg_pager_number number-'+r+'"></span>').text(r+1).addClass("paginationLink").bind("click",{newPage:r},function(t){l=t.data.newPage;f(s)}).appendTo(i)}$('<span class="wdg_pager_next"></span>').appendTo(i).addClass("clickable paginationButton nextPage");$('<span class="wdg_pager_next"></span>').appendTo(i).addClass("paginationButton lastPage").click(function(){l=o-1;f(s)});i.find("span.wdg_pager_number:first").addClass("active");i.children().css("cursor","pointer");$(".clickable").click(function(){if($(this).hasClass("wdg_pager_previous")){l=i.data("currentPage")-1}else{l=i.data("currentPage")+1}f(s)})};g();e(n);f()})});